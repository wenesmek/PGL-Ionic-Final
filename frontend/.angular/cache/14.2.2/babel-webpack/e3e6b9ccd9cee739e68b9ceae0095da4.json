{"ast":null,"code":"import _asyncToGenerator from \"/home/zining/Data/Proyectos/Ionic/UT1-pgl/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./juegues-nia-form.page.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./juegues-nia-form.page.scss?ngResource\";\nimport { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { JugueteService } from '../services/juguete.service';\nimport { PhotoService } from '../services/photo.service';\nlet JueguesNiaFormPage = class JueguesNiaFormPage {\n  constructor(activeRoute, jugueteService, router, photoService) {\n    this.activeRoute = activeRoute;\n    this.jugueteService = jugueteService;\n    this.router = router;\n    this.photoService = photoService;\n    this.id = null;\n    this.capturedPhoto = '';\n    this.juguete = {\n      id: null,\n      nombre: '',\n      descripcion: '',\n      filename: ''\n    };\n  }\n\n  ngOnInit() {\n    this.activeRoute.params.subscribe(params => {\n      this.id = params.id;\n\n      if (this.id !== '0') {\n        this.getJuguete();\n      }\n    });\n  }\n\n  takePhoto() {\n    this.photoService.takePhoto().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  pickImage() {\n    this.photoService.pickImage().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  discardImage() {\n    this.capturedPhoto = null;\n  }\n\n  getJuguete() {\n    this.jugueteService.getJuguete(this.id, token).subscribe(response => {\n      this.juguete = response;\n      this.id = this.juguete.id;\n      this.capturedPhoto = this.juguete.filename !== '' ? 'http://localhost:8080/images/' + this.juguete.filename : '';\n    });\n  }\n\n  updateJuguete() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let blob = null;\n\n      if (_this.capturedPhoto !== 'http://localhost:8080/images/' + _this.juguete.filename && _this.capturedPhoto !== null) {\n        const response = yield fetch(_this.capturedPhoto);\n        blob = yield response.blob();\n      } else if (_this.capturedPhoto === null) {\n        _this.juguete.filename = '';\n      }\n\n      _this.jugueteService.updateJuguete(_this.juguete.id, _this.juguete, blob, token).subscribe(response => {\n        _this.getJuguete();\n      });\n    })();\n  }\n\n  deleteJuguete() {\n    this.jugueteService.deleteJuguete(this.id, token).subscribe(response => {\n      this.router.navigateByUrl('/juguetes-nia');\n    });\n  }\n\n  createJuguete() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      let blob = null;\n\n      if (_this2.capturedPhoto !== '') {\n        const response = yield fetch(_this2.capturedPhoto);\n        blob = yield response.blob();\n      }\n\n      _this2.jugueteService.createJuguete({\n        nombre: _this2.juguete.nombre,\n        descripcion: _this2.juguete.descripcion\n      }, blob, token).subscribe(response => {\n        _this2.router.navigateByUrl('/juguetes-nia');\n      });\n    })();\n  }\n\n};\n\nJueguesNiaFormPage.ctorParameters = () => [{\n  type: ActivatedRoute\n}, {\n  type: JugueteService\n}, {\n  type: Router\n}, {\n  type: PhotoService\n}];\n\nJueguesNiaFormPage = __decorate([Component({\n  selector: 'app-juegues-nia-form',\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], JueguesNiaFormPage);\nexport { JueguesNiaFormPage };","map":{"version":3,"mappings":"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","names":["Component","ActivatedRoute","Router","JugueteService","PhotoService","JueguesNiaFormPage","constructor","activeRoute","jugueteService","router","photoService","id","nombre","descripcion","filename","ngOnInit","params","subscribe","getJuguete","takePhoto","then","data","capturedPhoto","webPath","pickImage","discardImage","token","response","juguete","updateJuguete","blob","fetch","deleteJuguete","navigateByUrl","createJuguete","selector","template"],"sourceRoot":"","sources":["/home/zining/Data/Proyectos/Ionic/UT1-pgl/frontend/src/app/juegues-nia-form/juegues-nia-form.page.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\n\nimport {JugueteService} from '../services/juguete.service';\nimport {PhotoService} from '../services/photo.service';\n\n@Component({\n  selector: 'app-juegues-nia-form',\n  templateUrl: './juegues-nia-form.page.html',\n  styleUrls: ['./juegues-nia-form.page.scss'],\n})\nexport class JueguesNiaFormPage implements OnInit {\n\n  id: any = null;\n  capturedPhoto = '';\n\n  juguete: any = {\n    id: null,\n    nombre: '',\n    descripcion: '',\n    filename: '',\n  };\n\n  constructor(\n    private activeRoute: ActivatedRoute,\n    private jugueteService: JugueteService,\n    private router: Router,\n    private photoService: PhotoService\n  ) { }\n  ngOnInit() {\n    this.activeRoute.params.subscribe(params => {\n      this.id = params.id;\n\n      if (this.id !== '0'){\n        this.getJuguete();\n      }\n\n    });\n  }\n\n  takePhoto() {\n    this.photoService.takePhoto().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  pickImage() {\n    this.photoService.pickImage().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  discardImage() {\n    this.capturedPhoto = null;\n  }\n\n\n  getJuguete(){\n    this.jugueteService.getJuguete(this.id, token).subscribe(response =>{\n      this.juguete = response;\n      this.id = this.juguete.id;\n      this.capturedPhoto = this.juguete.filename !== '' ? 'http://localhost:8080/images/' + this.juguete.filename : '';\n\n    });\n  }\n\n  async updateJuguete(){\n    let blob = null;\n    if ((this.capturedPhoto !== 'http://localhost:8080/images/' + this.juguete.filename) && this.capturedPhoto !== null){\n      const response = await fetch(this.capturedPhoto);\n      blob = await response.blob();\n    }else if(this.capturedPhoto === null){\n      this.juguete.filename = '';\n    }\n    this.jugueteService.updateJuguete(this.juguete.id, this.juguete, blob, token).subscribe(response =>{\n      this.getJuguete();\n    });\n  }\n\n  deleteJuguete(){\n    this.jugueteService.deleteJuguete(this.id, token).subscribe(response =>{\n      this.router.navigateByUrl('/juguetes-nia');\n    });\n  }\n  async createJuguete(){\n    let blob = null;\n    if (this.capturedPhoto !== ''){\n      const response = await fetch(this.capturedPhoto);\n      blob = await response.blob();\n    }\n    this.jugueteService.createJuguete(\n      {\n        nombre: this.juguete.nombre,\n        descripcion: this.juguete.descripcion\n      }, blob, token).subscribe(response =>{\n\n      this.router.navigateByUrl('/juguetes-nia');\n    });\n\n\n  }\n}\n"]},"metadata":{},"sourceType":"module"}