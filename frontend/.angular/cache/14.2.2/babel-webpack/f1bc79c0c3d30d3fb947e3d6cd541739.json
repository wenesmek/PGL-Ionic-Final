{"ast":null,"code":"import _asyncToGenerator from \"/home/zining/Data/Proyectos/Ionic/UT1-pgl/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./juegues-nia-form.page.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./juegues-nia-form.page.scss?ngResource\";\nimport { Component } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AlertController } from \"@ionic/angular\";\nimport { Storage } from \"@ionic/storage\";\nimport { JugueteService } from '../services/juguete.service';\nimport { PhotoService } from '../services/photo.service';\nlet JueguesNiaFormPage = class JueguesNiaFormPage {\n  constructor(activeRoute, jugueteService, router, photoService, storage, alertController) {\n    this.activeRoute = activeRoute;\n    this.jugueteService = jugueteService;\n    this.router = router;\n    this.photoService = photoService;\n    this.storage = storage;\n    this.alertController = alertController;\n    this.id = null;\n    this.capturedPhoto = '';\n    this.juguete = {\n      id: null,\n      nombre: '',\n      descripcion: '',\n      filename: ''\n    };\n  }\n\n  ngOnInit() {\n    this.activeRoute.params.subscribe(params => {\n      this.id = params.id;\n      this.juguete.reset;\n\n      if (this.id !== '0') {\n        this.getJuguete();\n      }\n    });\n  }\n\n  takePhoto() {\n    this.photoService.takePhoto().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  pickImage() {\n    this.photoService.pickImage().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  discardImage() {\n    this.capturedPhoto = null;\n  }\n\n  getJuguete() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const token = yield _this.storage.get('token');\n\n      _this.jugueteService.getJuguete(_this.id, token).subscribe(response => {\n        _this.juguete = response;\n        _this.id = _this.juguete.id;\n        _this.capturedPhoto = _this.juguete.filename !== '' ? 'http://localhost:8080/images/' + _this.juguete.filename : '';\n      });\n    })();\n  }\n\n  updateJuguete() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const alert = yield _this2.alertController.create({\n        header: 'Cuidado',\n        buttons: [{\n          text: 'Cancelar',\n          role: 'cancel',\n          handler: () => {}\n        }]\n      });\n      const token = yield _this2.storage.get('token');\n      let blob = null;\n\n      if (_this2.capturedPhoto !== 'http://localhost:8080/images/' + _this2.juguete.filename && _this2.capturedPhoto !== null) {\n        const response = yield fetch(_this2.capturedPhoto);\n        blob = yield response.blob();\n      } else if (_this2.capturedPhoto === null) {\n        _this2.juguete.filename = '';\n      }\n\n      _this2.jugueteService.updateJuguete(_this2.juguete.id, _this2.juguete, blob, token).subscribe(response => {\n        _this2.getJuguete();\n      });\n    })();\n  }\n\n  deleteJuguete() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const token = yield _this3.storage.get('token');\n\n      _this3.jugueteService.deleteJuguete(_this3.id, token).subscribe(response => {\n        _this3.router.navigateByUrl('/juguetes-nia');\n      });\n    })();\n  }\n\n  createJuguete() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      const token = yield _this4.storage.get('token');\n      let blob = null;\n\n      if (_this4.capturedPhoto !== '') {\n        const response = yield fetch(_this4.capturedPhoto);\n        blob = yield response.blob();\n      }\n\n      _this4.jugueteService.createJuguete({\n        nombre: _this4.juguete.nombre,\n        descripcion: _this4.juguete.descripcion\n      }, blob, token).subscribe(response => {\n        _this4.router.navigateByUrl('/juguetes-nia');\n      });\n    })();\n  }\n\n};\n\nJueguesNiaFormPage.ctorParameters = () => [{\n  type: ActivatedRoute\n}, {\n  type: JugueteService\n}, {\n  type: Router\n}, {\n  type: PhotoService\n}, {\n  type: Storage\n}, {\n  type: AlertController\n}];\n\nJueguesNiaFormPage = __decorate([Component({\n  selector: 'app-juegues-nia-form',\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], JueguesNiaFormPage);\nexport { JueguesNiaFormPage };","map":{"version":3,"mappings":"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","names":["Component","ActivatedRoute","Router","AlertController","Storage","JugueteService","PhotoService","JueguesNiaFormPage","constructor","activeRoute","jugueteService","router","photoService","storage","alertController","id","nombre","descripcion","filename","ngOnInit","params","subscribe","juguete","reset","getJuguete","takePhoto","then","data","capturedPhoto","webPath","pickImage","discardImage","token","get","response","updateJuguete","alert","create","header","buttons","text","role","handler","blob","fetch","deleteJuguete","navigateByUrl","createJuguete","selector","template"],"sourceRoot":"","sources":["/home/zining/Data/Proyectos/Ionic/UT1-pgl/frontend/src/app/juegues-nia-form/juegues-nia-form.page.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {AlertController} from \"@ionic/angular\";\n\nimport { Storage } from \"@ionic/storage\";\n\nimport {JugueteService} from '../services/juguete.service';\nimport {PhotoService} from '../services/photo.service';\n\n@Component({\n  selector: 'app-juegues-nia-form',\n  templateUrl: './juegues-nia-form.page.html',\n  styleUrls: ['./juegues-nia-form.page.scss'],\n})\nexport class JueguesNiaFormPage implements OnInit {\n\n  id: any = null;\n  capturedPhoto = '';\n\n  juguete: any = {\n    id: null,\n    nombre: '',\n    descripcion: '',\n    filename: '',\n  };\n\n\n  constructor(\n    private activeRoute: ActivatedRoute,\n    private jugueteService: JugueteService,\n    private router: Router,\n    private photoService: PhotoService,\n    private storage: Storage,\n    private alertController: AlertController\n  ) { }\n  ngOnInit() {\n    this.activeRoute.params.subscribe(params => {\n      this.id = params.id;\n\n      this.juguete.reset\n\n      if (this.id !== '0'){\n        this.getJuguete();\n      }\n\n    });\n  }\n\n  takePhoto() {\n    this.photoService.takePhoto().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  pickImage() {\n    this.photoService.pickImage().then(data => {\n      this.capturedPhoto = data.webPath;\n    });\n  }\n\n  discardImage() {\n    this.capturedPhoto = null;\n  }\n\n\n  async getJuguete(){\n    const token = await this.storage.get('token');\n\n    this.jugueteService.getJuguete(this.id, token).subscribe(response =>{\n      this.juguete = response;\n      this.id = this.juguete.id;\n      this.capturedPhoto = this.juguete.filename !== '' ? 'http://localhost:8080/images/' + this.juguete.filename : '';\n\n    });\n  }\n\n  async updateJuguete(){\n\n    const alert = await this.alertController.create({\n      header: 'Cuidado',\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          handler: () => {\n            \n          }\n\n        }\n      ]\n    })\n\n    const token = await this.storage.get('token');\n\n\n    let blob = null;\n    if ((this.capturedPhoto !== 'http://localhost:8080/images/' + this.juguete.filename) && this.capturedPhoto !== null){\n      const response = await fetch(this.capturedPhoto);\n      blob = await response.blob();\n    }else if(this.capturedPhoto === null){\n      this.juguete.filename = '';\n    }\n    this.jugueteService.updateJuguete(this.juguete.id, this.juguete, blob, token).subscribe(response =>{\n      this.getJuguete();\n    });\n  }\n\n  async deleteJuguete(){\n    const token = await this.storage.get('token');\n\n    this.jugueteService.deleteJuguete(this.id, token).subscribe(response =>{\n      this.router.navigateByUrl('/juguetes-nia');\n    });\n  }\n  async createJuguete(){\n    const token = await this.storage.get('token');\n\n    let blob = null;\n    if (this.capturedPhoto !== ''){\n      const response = await fetch(this.capturedPhoto);\n      blob = await response.blob();\n    }\n    this.jugueteService.createJuguete(\n      {\n        nombre: this.juguete.nombre,\n        descripcion: this.juguete.descripcion\n      }, blob, token).subscribe(response =>{\n\n      this.router.navigateByUrl('/juguetes-nia');\n    });\n\n\n  }\n}\n"]},"metadata":{},"sourceType":"module"}